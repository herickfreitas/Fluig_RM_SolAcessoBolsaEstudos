--USE [Corporerm_Homolog]
--GO

/****** Object:  View [dbo].[_Fluig_COLABORADORES]    Script Date: 17/05/2022 14:52:12 ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO






ALTER VIEW [dbo].[_Fluig_COLABORADORES] AS

SELECT * FROM (

			SELECT PPESSOA.NOME AS COLABORADOR, LOWER(PPESSOA.CODUSUARIO) AS CODUSUARIO, convert(varchar, PFUNC.DATAADMISSAO, 103) DATAADMISSAO, 
			DATEDIFF(yy,PFUNC.DATAADMISSAO,GETDATE()) AS TEMPOCASA_ANOS,
			UPPER(PSECAO.DESCRICAO) AS NOME_SECAO, PSECAO.CODFILIAL, UPPER(PFUNCAO.NOME) AS NOME_FUNCAO,
			
			LOWER(CHEFE.CODUSUARIO) AS CODUSUARIO_CHEFE, CHEFE.NOME AS CHEFE
							FROM PFUNC
							JOIN	PSECAO			ON (PFUNC.CODSECAO=PSECAO.CODIGO)
							JOIN	PFUNCAO			ON (PFUNC.CODFUNCAO=PFUNCAO.CODIGO)
							JOIN	PPESSOA			ON (PFUNC.CODPESSOA=PPESSOA.CODIGO)
							JOIN	GCCUSTO			ON (PSECAO.NROCENCUSTOCONT=GCCUSTO.CODCCUSTO)
							JOIN	PPESSOA CHEFE   ON (GCCUSTO.RESPONSAVEL=CHEFE.CODIGO)
							WHERE 	CODSITUACAO		<> 'D'
				)T1

WHERE T1.CODUSUARIO IS NOT NULL 

/*
UNION ALL 
SELECT 'JOSE ROBERTO TADROS' AS COLABORADOR, 'robertotadros' AS CODUSUARIO, '01/01/2000' AS DATAADMISSAO, upper('Diretoria CNC') AS NOME_SECAO, upper('Diretor Presidente') AS NOME_FUNCAO,
'robertotadros' AS CODUSUARIO_CHEFE, 'JOSE ROBERTO TADROS' AS CHEFE

UNION ALL 
 select 'ADMINISTRADOR FLUIG' AS COLABORADOR, 'adminfluig' AS CODUSUARIO, '01/01/2000' AS DATAADMISSAO,'ADMINISTRADOR FLUIG' AS NOME_SECAO, 'ADMINISTRADOR FLUIG' AS NOME_FUNCAO,
'adminfluig' AS CODUSUARIO_CHEFE, 'ADMINISTRADOR FLUIG' AS CHEFE

UNION ALL 
 select 'LENI VALADAO' AS COLABORADOR, 'lenivaladao' AS CODUSUARIO, '01/01/2000' AS DATAADMISSAO,'GABINETE DA VICE-PRESIDÊNCIA FINANCEIRA - RJ' AS NOME_SECAO, 'ASSESSOR EXECUTIVO DE GABINETE' AS NOME_FUNCAO,
'lenivaladao' AS CODUSUARIO_CHEFE, 'LENI VALADAO' AS CHEFE

UNION ALL 
 select 'MARCELO FERNANDES DE QUEIROZ' AS COLABORADOR, 'marceloqueiroz' AS CODUSUARIO, '01/01/2000' AS DATAADMISSAO,'VICE-PRESIDÊNCIA ADMINISTRATIVA' AS NOME_SECAO, 'VICE-PRESIDENTE ADMINISTRATIVO' AS NOME_FUNCAO,
'marceloqueiroz' AS CODUSUARIO_CHEFE, 'MARCELO FERNANDES DE QUEIROZ' AS CHEFE

UNION ALL 
 select 'THALITA ZUCHELLI VARELA' AS COLABORADOR, 'thalitavarela' AS CODUSUARIO, '01/01/2000' AS DATAADMISSAO, 'DIVISAO DE ADMINISTRACAO' AS NOME_SECAO, 'ASSISTENTE DE ADMINISTRAÇÃO' AS NOME_FUNCAO,
'marcusfernandes' AS CODUSUARIO_CHEFE, 'MARCUS VINICIUS MACHADO FERNANDES' AS CHEFE

UNION ALL 
 select 'GISELLE DAMASCO MONTEIRO NISMACHIN' AS COLABORADOR, 'gisellemonteiro' AS CODUSUARIO, '01/01/2000' AS DATAADMISSAO, 'ASSESSORIA DE EVENTOS - RJ' AS NOME_SECAO, 'ASSESSORA DE EVENTOS' AS NOME_FUNCAO,
'simoneguimaraes' AS CODUSUARIO_CHEFE, 'SIMONE DE SOUZA GUIMARAES' AS CHEFE

*/
			 	

GO


